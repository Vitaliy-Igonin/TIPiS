<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ 5-—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ —Å–µ—á–µ–Ω–∏—è</title>
    <script src="https://cdn.plot.ly/plotly-2.20.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #808cc1 0%, #837790 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #6d79b0 0%, #a27bc8 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header h2 {
            font-size: 18px;
            opacity: 0.9;
            font-weight: 400;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 30px;
            padding: 30px;
        }

        @media (max-width: 1200px) {
            .content {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .panel h3 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            font-size: 22px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
            align-items: center;
        }

        .input-row label {
            min-width: 80px;
            font-weight: 500;
            color: #555;
        }

        input[type="number"] {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        button {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .reset-btn {
            background: #f1f3f9;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .reset-btn:hover {
            background: #667eea;
            color: white;
        }

        .results {
            margin-top: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        .results h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }

        .result-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .result-value {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        #plot-container {
            width: 100%;
            height: 500px;
            margin-top: 10px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid #e0e0e0;
        }

        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }

        .info-box h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .info-box p {
            color: #555;
            line-height: 1.6;
            font-size: 14px;
        }

        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .scenario-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .scenario-btn {
            padding: 10px 15px;
            background: #e3f2fd;
            border: 1px solid #2196F3;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            text-align: left;
        }

        .scenario-btn:hover {
            background: #bbdefb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ 5-—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ —Å–µ—á–µ–Ω–∏—è</h1>
            <h2>–û—Ü–µ–Ω–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</h2>
        </div>

        <div class="content">
            <div class="panel">
                <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã</h3>
                
                <div class="info-box">
                    <h4>–°–ø—Ä–∞–≤–∫–∞</h4>
                    <p>–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –í—Å–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π: 2‚Åµ = 32.</p>
                    <p>Œª·µ¢ - –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–æ–≤ i-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (1/—á–∞—Å)</p>
                    <p>Œº·µ¢ - –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è i-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (1/—á–∞—Å)</p>
                </div>

                <div class="input-group">
                    <h4>–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –æ—Ç–∫–∞–∑–æ–≤ Œª·µ¢</h4>
                    <div class="input-row">
                        <label>Œª‚ÇÅ:</label>
                        <input type="number" id="lambda1" value="0.1" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œª‚ÇÇ:</label>
                        <input type="number" id="lambda2" value="0.1" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œª‚ÇÉ:</label>
                        <input type="number" id="lambda3" value="0.1" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œª‚ÇÑ:</label>
                        <input type="number" id="lambda4" value="0.1" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œª‚ÇÖ:</label>
                        <input type="number" id="lambda5" value="0.1" step="0.1" min="0">
                    </div>
                </div>

                <div class="input-group">
                    <h4>–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è Œº·µ¢</h4>
                    <div class="input-row">
                        <label>Œº‚ÇÅ:</label>
                        <input type="number" id="mu1" value="1.0" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œº‚ÇÇ:</label>
                        <input type="number" id="mu2" value="1.0" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œº‚ÇÉ:</label>
                        <input type="number" id="mu3" value="1.0" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œº‚ÇÑ:</label>
                        <input type="number" id="mu4" value="1.0" step="0.1" min="0">
                    </div>
                    <div class="input-row">
                        <label>Œº‚ÇÖ:</label>
                        <input type="number" id="mu5" value="1.0" step="0.1" min="0">
                    </div>
                </div>

                <div class="input-group">
                    <h4>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞</h4>
                    <div class="input-row">
                        <label>–í—Ä–µ–º—è T (—á):</label>
                        <input type="number" id="time" value="10" step="1" min="1">
                    </div>
                    <div class="input-row">
                        <label>–®–∞–≥–æ–≤:</label>
                        <input type="number" id="steps" value="1000" step="100" min="100">
                    </div>
                </div>

                <div class="input-group">
                    <h4>–ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</h4>
                    <div class="scenario-buttons">
                        <button class="scenario-btn" onclick="setScenario1()">
                            1. –í—ã—Å–æ–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å (Œª=0.1, Œº=10)
                        </button>
                        <button class="scenario-btn" onclick="setScenario2()">
                            2. –ù–∏–∑–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å (Œª=2, Œº=0)
                        </button>
                        <button class="scenario-btn" onclick="setScenario3()">
                            3. –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (Œª=3, Œº=2)
                        </button>
                        <button class="scenario-btn" onclick="setScenario4()">
                            4. –í—ã—Å–æ–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (Œª=3, Œº=4)
                        </button>
                    </div>
                </div>

                <div class="controls">
                    <button class="calculate-btn" onclick="calculate()">
                        üìà –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫
                    </button>
                    <button class="reset-btn" onclick="resetValues()">
                        üîÑ –°–±—Ä–æ—Å–∏—Ç—å
                    </button>
                </div>

                <div class="results">
                    <h4>–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</h4>
                    <div class="results-grid" id="results-container">
                        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <div class="panel">
                <h3>–ì—Ä–∞—Ñ–∏–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π</h3>
                
                <div id="plot-container">
                    <!-- –ì—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <div class="legend" id="plot-legend">
                    <!-- –õ–µ–≥–µ–Ω–¥–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
                </div>
                
                <div class="info-box" style="margin-top: 20px;">
                    <h4>–ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ –≥—Ä–∞—Ñ–∏–∫–∞–º</h4>
                    <p>–ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ–∫–∞–∑–∞–Ω—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∫–∞–∑–∞–≤—à–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>–í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç</strong> - –≤—Å–µ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏—Å–ø—Ä–∞–≤–Ω—ã</li>
                        <li><strong>1 –æ—Ç–∫–∞–∑–∞–ª</strong> - —Å—É–º–º–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å –æ–¥–Ω–∏–º –æ—Ç–∫–∞–∑–∞–≤—à–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º</li>
                        <li><strong>2 –æ—Ç–∫–∞–∑–∞–ª–æ</strong> - —Å—É–º–º–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å –¥–≤—É–º—è –æ—Ç–∫–∞–∑–∞–≤—à–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏</li>
                        <li><strong>3 –æ—Ç–∫–∞–∑–∞–ª–æ</strong> - —Å—É–º–º–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å —Ç—Ä–µ–º—è –æ—Ç–∫–∞–∑–∞–≤—à–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏</li>
                        <li><strong>4 –æ—Ç–∫–∞–∑–∞–ª–æ</strong> - —Å—É–º–º–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å —á–µ—Ç—ã—Ä—å–º—è –æ—Ç–∫–∞–∑–∞–≤—à–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏</li>
                        <li><strong>–í—Å–µ –æ—Ç–∫–∞–∑–∞–ª–∏</strong> - –≤—Å–µ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        const n = 5; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        const states = Math.pow(2, n); // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π (32)
        
        // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø —Å–æ—Å—Ç–æ—è–Ω–∏–π
        const colors = {
            allWorking: '#4CAF50',     // –í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç
            oneFailed: '#2196F3',      // –û–¥–∏–Ω –æ—Ç–∫–∞–∑–∞–ª
            twoFailed: '#FF9800',      // –î–≤–∞ –æ—Ç–∫–∞–∑–∞–ª–æ
            threeFailed: '#9C27B0',    // –¢—Ä–∏ –æ—Ç–∫–∞–∑–∞–ª–æ
            fourFailed: '#FF5722',     // –ß–µ—Ç—ã—Ä–µ –æ—Ç–∫–∞–∑–∞–ª–æ
            allFailed: '#f44336'       // –í—Å–µ –æ—Ç–∫–∞–∑–∞–ª–∏
        };

        // –†–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π
        function solveKolmogorovEquations(lambdas, mus, time, steps) {
            const dt = time / steps;
            const P = new Array(states).fill().map(() => new Array(steps + 1).fill(0));
            
            // –ù–∞—á–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è: —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞
            P[0][0] = 1;
            
            // –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
            const Q = new Array(states).fill().map(() => new Array(states).fill(0));
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–µ–π
            for (let i = 0; i < states; i++) {
                for (let j = 0; j < n; j++) {
                    const bit = (i >> j) & 1;
                    if (bit === 0) {
                        // –û—Ç–∫–∞–∑ —ç–ª–µ–º–µ–Ω—Ç–∞ j
                        const toState = i | (1 << j);
                        Q[i][toState] = lambdas[j];
                    } else {
                        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ j
                        const toState = i & ~(1 << j);
                        Q[i][toState] = mus[j];
                    }
                }
                
                // –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
                Q[i][i] = -sum(Q[i]);
            }
            
            // –†–µ—à–∞–µ–º —Å–∏—Å—Ç–µ–º—É –º–µ—Ç–æ–¥–æ–º –≠–π–ª–µ—Ä–∞
            for (let t = 0; t < steps; t++) {
                for (let i = 0; i < states; i++) {
                    let derivative = 0;
                    for (let j = 0; j < states; j++) {
                        derivative += Q[j][i] * P[j][t];
                    }
                    P[i][t + 1] = P[i][t] + derivative * dt;
                    
                    // –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
                    P[i][t + 1] = Math.max(0, P[i][t + 1]);
                }
                
                // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
                const sumP = P.reduce((sum, p) => sum + p[t + 1], 0);
                if (sumP > 0) {
                    for (let i = 0; i < states; i++) {
                        P[i][t + 1] /= sumP;
                    }
                }
            }
            
            return P;
        }

        function sum(arr) {
            return arr.reduce((a, b) => a + b, 0);
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞
        function calculate() {
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
            const lambdas = [
                parseFloat(document.getElementById('lambda1').value),
                parseFloat(document.getElementById('lambda2').value),
                parseFloat(document.getElementById('lambda3').value),
                parseFloat(document.getElementById('lambda4').value),
                parseFloat(document.getElementById('lambda5').value)
            ];
            
            const mus = [
                parseFloat(document.getElementById('mu1').value),
                parseFloat(document.getElementById('mu2').value),
                parseFloat(document.getElementById('mu3').value),
                parseFloat(document.getElementById('mu4').value),
                parseFloat(document.getElementById('mu5').value)
            ];
            
            const time = parseFloat(document.getElementById('time').value);
            const steps = parseInt(document.getElementById('steps').value);
            
            // –†–µ—à–∞–µ–º —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π
            const P = solveKolmogorovEquations(lambdas, mus, time, steps);
            
            // –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
            const timePoints = Array.from({length: steps + 1}, (_, i) => i * time / steps);
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ç–∫–∞–∑–∞–≤—à–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const groupedProbabilities = {
                allWorking: new Array(steps + 1).fill(0),
                oneFailed: new Array(steps + 1).fill(0),
                twoFailed: new Array(steps + 1).fill(0),
                threeFailed: new Array(steps + 1).fill(0),
                fourFailed: new Array(steps + 1).fill(0),
                allFailed: new Array(steps + 1).fill(0)
            };
            
            for (let t = 0; t <= steps; t++) {
                for (let i = 0; i < states; i++) {
                    const binary = i.toString(2).padStart(n, '0');
                    const failedCount = (binary.match(/1/g) || []).length;
                    
                    if (failedCount === 0) groupedProbabilities.allWorking[t] += P[i][t];
                    else if (failedCount === 1) groupedProbabilities.oneFailed[t] += P[i][t];
                    else if (failedCount === 2) groupedProbabilities.twoFailed[t] += P[i][t];
                    else if (failedCount === 3) groupedProbabilities.threeFailed[t] += P[i][t];
                    else if (failedCount === 4) groupedProbabilities.fourFailed[t] += P[i][t];
                    else groupedProbabilities.allFailed[t] += P[i][t];
                }
            }
            
            // –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏
            plotProbabilities(timePoints, groupedProbabilities);
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
            displayStationaryProbabilities(groupedProbabilities, steps);
        }

        // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é Plotly
        function plotProbabilities(timePoints, probabilities) {
            const traces = [
                {
                    x: timePoints,
                    y: probabilities.allWorking,
                    mode: 'lines',
                    name: '–í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç',
                    line: {color: colors.allWorking, width: 3}
                },
                {
                    x: timePoints,
                    y: probabilities.oneFailed,
                    mode: 'lines',
                    name: '1 –æ—Ç–∫–∞–∑–∞–ª',
                    line: {color: colors.oneFailed, width: 2.5}
                },
                {
                    x: timePoints,
                    y: probabilities.twoFailed,
                    mode: 'lines',
                    name: '2 –æ—Ç–∫–∞–∑–∞–ª–æ',
                    line: {color: colors.twoFailed, width: 2}
                },
                {
                    x: timePoints,
                    y: probabilities.threeFailed,
                    mode: 'lines',
                    name: '3 –æ—Ç–∫–∞–∑–∞–ª–æ',
                    line: {color: colors.threeFailed, width: 1.5}
                },
                {
                    x: timePoints,
                    y: probabilities.fourFailed,
                    mode: 'lines',
                    name: '4 –æ—Ç–∫–∞–∑–∞–ª–æ',
                    line: {color: colors.fourFailed, width: 1}
                },
                {
                    x: timePoints,
                    y: probabilities.allFailed,
                    mode: 'lines',
                    name: '–í—Å–µ –æ—Ç–∫–∞–∑–∞–ª–∏',
                    line: {color: colors.allFailed, width: 2}
                }
            ];
            
            const layout = {
                title: {
                    text: '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã',
                    font: {size: 18}
                },
                xaxis: {
                    title: '–í—Ä–µ–º—è (—á–∞—Å—ã)',
                    gridcolor: '#f0f0f0',
                    zerolinecolor: '#f0f0f0'
                },
                yaxis: {
                    title: '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å',
                    range: [0, 1],
                    gridcolor: '#f0f0f0',
                    zerolinecolor: '#f0f0f0',
                    tickformat: '.2f'
                },
                plot_bgcolor: '#f9f9f9',
                paper_bgcolor: '#f9f9f9',
                hovermode: 'x unified',
                legend: {
                    orientation: 'h',
                    y: -0.2,
                    x: 0.5,
                    xanchor: 'center'
                },
                margin: {t: 60, r: 30, b: 80, l: 50}
            };
            
            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['pan2d', 'lasso2d', 'select2d'],
                modeBarButtonsToAdd: ['drawline', 'drawopenpath', 'drawclosedpath', 'drawcircle', 'drawrect', 'eraseshape']
            };
            
            Plotly.newPlot('plot-container', traces, layout, config);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–µ–≥–µ–Ω–¥—É
            updatePlotLegend();
        }

        function updatePlotLegend() {
            const legend = document.getElementById('plot-legend');
            legend.innerHTML = '<h4>–õ–µ–≥–µ–Ω–¥–∞:</h4>';
            
            const legendItems = [
                {label: '–í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç', color: colors.allWorking},
                {label: '1 –æ—Ç–∫–∞–∑–∞–ª', color: colors.oneFailed},
                {label: '2 –æ—Ç–∫–∞–∑–∞–ª–æ', color: colors.twoFailed},
                {label: '3 –æ—Ç–∫–∞–∑–∞–ª–æ', color: colors.threeFailed},
                {label: '4 –æ—Ç–∫–∞–∑–∞–ª–æ', color: colors.fourFailed},
                {label: '–í—Å–µ –æ—Ç–∫–∞–∑–∞–ª–∏', color: colors.allFailed}
            ];
            
            legendItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'legend-item';
                div.innerHTML = `
                    <div class="legend-color" style="background: ${item.color};"></div>
                    <span>${item.label}</span>
                `;
                legend.appendChild(div);
            });
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
        function displayStationaryProbabilities(probabilities, steps) {
            const results = document.getElementById('results-container');
            results.innerHTML = '';
            
            const stationaryProbs = {
                '–í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç': probabilities.allWorking[steps],
                '1 –æ—Ç–∫–∞–∑–∞–ª': probabilities.oneFailed[steps],
                '2 –æ—Ç–∫–∞–∑–∞–ª–æ': probabilities.twoFailed[steps],
                '3 –æ—Ç–∫–∞–∑–∞–ª–æ': probabilities.threeFailed[steps],
                '4 –æ—Ç–∫–∞–∑–∞–ª–æ': probabilities.fourFailed[steps],
                '–í—Å–µ –æ—Ç–∫–∞–∑–∞–ª–∏': probabilities.allFailed[steps]
            };
            
            for (const [label, value] of Object.entries(stationaryProbs)) {
                const div = document.createElement('div');
                div.className = 'result-item';
                div.innerHTML = `
                    <div class="result-label">${label}</div>
                    <div class="result-value">${value.toFixed(6)}</div>
                `;
                results.appendChild(div);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
        function setScenario1() {
            // –í—ã—Å–æ–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
            document.getElementById('lambda1').value = '0.1';
            document.getElementById('lambda2').value = '0.1';
            document.getElementById('lambda3').value = '0.1';
            document.getElementById('lambda4').value = '0.1';
            document.getElementById('lambda5').value = '0.1';
            
            document.getElementById('mu1').value = '10';
            document.getElementById('mu2').value = '10';
            document.getElementById('mu3').value = '10';
            document.getElementById('mu4').value = '10';
            document.getElementById('mu5').value = '10';
            
            calculate();
        }

        function setScenario2() {
            // –ù–∏–∑–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
            document.getElementById('lambda1').value = '2';
            document.getElementById('lambda2').value = '2';
            document.getElementById('lambda3').value = '2';
            document.getElementById('lambda4').value = '2';
            document.getElementById('lambda5').value = '2';
            
            document.getElementById('mu1').value = '0';
            document.getElementById('mu2').value = '0';
            document.getElementById('mu3').value = '0';
            document.getElementById('mu4').value = '0';
            document.getElementById('mu5').value = '0';
            
            calculate();
        }

        function setScenario3() {
            // –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
            document.getElementById('lambda1').value = '3';
            document.getElementById('lambda2').value = '3';
            document.getElementById('lambda3').value = '3';
            document.getElementById('lambda4').value = '3';
            document.getElementById('lambda5').value = '3';
            
            document.getElementById('mu1').value = '2';
            document.getElementById('mu2').value = '2';
            document.getElementById('mu3').value = '2';
            document.getElementById('mu4').value = '2';
            document.getElementById('mu5').value = '2';
            
            calculate();
        }

        function setScenario4() {
            // –í—ã—Å–æ–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
            document.getElementById('lambda1').value = '3';
            document.getElementById('lambda2').value = '3';
            document.getElementById('lambda3').value = '3';
            document.getElementById('lambda4').value = '3';
            document.getElementById('lambda5').value = '3';
            
            document.getElementById('mu1').value = '4';
            document.getElementById('mu2').value = '4';
            document.getElementById('mu3').value = '4';
            document.getElementById('mu4').value = '4';
            document.getElementById('mu5').value = '4';
            
            calculate();
        }

        // –°–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º
        function resetValues() {
            document.getElementById('lambda1').value = '0.1';
            document.getElementById('lambda2').value = '0.1';
            document.getElementById('lambda3').value = '0.1';
            document.getElementById('lambda4').value = '0.1';
            document.getElementById('lambda5').value = '0.1';
            
            document.getElementById('mu1').value = '1.0';
            document.getElementById('mu2').value = '1.0';
            document.getElementById('mu3').value = '1.0';
            document.getElementById('mu4').value = '1.0';
            document.getElementById('mu5').value = '1.0';
            
            document.getElementById('time').value = '10';
            document.getElementById('steps').value = '1000';
            
            // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            document.getElementById('results-container').innerHTML = '';
            Plotly.purge('plot-container');
            document.getElementById('plot-legend').innerHTML = '';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            calculate(); // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', function() {
                Plotly.Plots.resize(document.getElementById('plot-container'));
            });
        };
    </script>
</body>
</html>